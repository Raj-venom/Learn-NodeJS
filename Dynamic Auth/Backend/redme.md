check roles and give permission

pass a middleware to check roles and permission